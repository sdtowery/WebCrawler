from os.path import exists
from os import remove
import csv
import numpy as np
from pandas.io import html
from sklearn.metrics.pairwise import euclidean_distances

# Helper methods for wapper.py and simpleSteadyStateGA.py

# writes the feature masked csv file
#
# Params: feature_mask


def write_feature_mask_dataset(feature_mask):
    base_dataset = "HTML_malware_dataset.csv"
    feature_mask_dataset = "feature_mask_dataset.csv"

    feature_mask = [1, 1] + feature_mask
    feature_mask = np.array(feature_mask, dtype=bool)

    try:
        if exists(feature_mask_dataset):
            remove(feature_mask_dataset)

        feature_mask_file = open(feature_mask_dataset, 'x', newline='')
        base_dataset_file = open(base_dataset, 'r')

        csv_reader = csv.reader(base_dataset_file)
        csv_writer = csv.writer(feature_mask_file)
        i = 0
        for row in csv_reader:
            # copy the first row of the base dataset to the new dataset
            if i == 0:
                csv_writer.writerow(row)
                i += 1
                continue

            repl = [0]
            row_np = np.array(row, dtype=float)
            row_np[~feature_mask] = repl

            csv_writer.writerow(row_np)

        feature_mask_file.close()
        base_dataset_file.close()
    except Exception as err:
        print(f"Error: {err}")


# Writes the given row to the specified csv file
#
# Params: filename, row


def write_to_csv(file_name, row):
    try:
        if exists(file_name):
            file = open(file_name, 'a', newline='')
        else:
            file = open(file_name, 'x', newline='')

        csv_writer = csv.writer(file)
        csv_writer.writerow(row)
        file.close()
    except Exception as err:
        print(f"Error: {err}")


def sum_html_malware_dataset():
    base_dataset = "HTML_malware_dataset.csv"
    total_sums = []
    html_malware_dataset = open(base_dataset, 'r')
    csv_reader = csv.reader(html_malware_dataset)
    j = 0
    for row in csv_reader:
        if j == 0:
            j += 1
            continue
        row_sum = 0
        for i in range(2, len(row)):
            row_sum += float(row[i])

        total_sums.append(row_sum)

    for i in range(len(total_sums)):
        print(f"Webpage {i + 1}: {total_sums[i]}")

def measure_distances():
    # -- Negatives -- #
    best_instances = [
        [0.0678607314237026, 0.002693089588034098, 0.06681318616095389, 0.04237339899233467, 0.02695211395575491, 0.0, 0.025275090507579825, 0.0, 0.006364053028947081, 0.00022936901123069074, 0.017718994408414256, 0.007201230422689502, 0.020586210706633596, 0.0468779481151541, 0.03239329607289307, 0.04087960732112205, 0.04659287548450955, 0.04056296426229166, 0.010595421476848246, 0.007677789351007965, 0.017562493047600325, 0.035996266501440236, 0.0, 0.0210025937243336, 0.020699874363493975, 0.020283119182707175, 0.004641114860888819, 0.010428484007765571, 0.004472117317831571, 0.0020805770697149076, 0.0024642131271618833, 0.013026896371278424, 0.018427186384605884, 0.0, 0.017197807742929533, 0.006371630064510399, 0.011733911072575105, 0.007164971166155717, 0.002226568079919445, 0.0, 0.0, 0.0, 0.0016903499794071524, 0.0, 0.01564643466214005, 0.0017280697659229627, 0.0, 0.0035273855994856825, 0.023877090411434404, 0.0018337891789891665, 0.011509968917243926, 0.013980811776714465, 0.011353451880380602, 0.0, 0.009023126169718508, 0.010982425350865509, 0.0, 0.02395366445907293, 0.008879841000880247, 0.0, 0.005390216673907602, 0.014529588265134305, 0.011740541137393921, 0.01671950083478796, 0.013749731503351337, 0.09255816717761123, 0.0, 0.030927287604911587, 0.0, 0.042979827471172696, 0.006404603060396961, 0.014919108058034727, 0.03058902028394325, 0.09116954318090013, 0.0, 0.037091788672481286, 0.05784545209332462, 0.006290814868825162, 0.007510084433606804, 0.0861873665008645, 0.0, 0.018356164589840337, 0.010418648741684577, 0.03553510081807109, 0.03657154024212873, 0.0859184000876069, 0.0053861348668126485, 0.0, 0.0, 0.0, 0.014043535551397446, 0.00273624617506966, 0.0, 0.011503726375210853, 0.0],
        [0.05290875943073489, 0.01557733629574903, 0.06198911833716667, 0.0461855873574935, 0.005110465402435531, 0.01616315648658059, 0.02710836989106092, 0.0026797974501248656, 0.023301357024790845, 0.0, 0.0, 0.0060392834390469025, 0.011380686687573905, 0.054514859268636987, 0.029691199832325953, 0.0381340328938895, 0.028134798414185713, 0.048100900200451525, 0.02530962136550094, 0.0, 0.0, 0.012920688918797125, 0.0059979409460178415, 0.015407077640618903, 0.013775904661341078, 0.022559337860329966, 0.02146025446507101, 0.010492916302950015, 0.0, 0.00244934138258596, 0.009232589714246797, 0.0, 0.017847659282690467, 0.005465259650389129, 0.00847976719894129, 0.008195111478040513, 0.003486424040653686, 0.019523848373367864, 0.01546608823325218, 0.01553683552249999, 0.011969509765541423, 0.01809008213896996, 0.0, 0.003002518416228228, 0.005921753837915829, 0.00300911470878031, 0.007647774981807338, 7.58262621425729e-05, 0.026684435756242922, 0.01123757055843978, 0.013112222729127118, 0.018359711028711048, 0.007270665447899654, 0.015321941270411456, 0.0, 0.0, 0.005189940447748696, 0.011651751470569219, 0.0, 0.005968314333641008, 0.024681569315425835, 0.013580443240929461, 0.018247486120962747, 0.022905414055775224, 0.0, 0.08991059598822533, 0.008426121583544053, 0.028129295641207364, 0.0015050837409358352, 0.035107879005628735, 0.024139260619337317, 0.012110406165573856, 0.035970255929273075, 0.10226480027565224, 0.0, 0.0364746596313371, 0.04921670702177554, 0.013276305521324003, 0.019107663549164128, 0.08261072287944002, 0.0, 0.019802648649495415, 0.013540008435653922, 0.037040728417466015, 0.02191464645205417, 0.07543171044985769, 0.00296066591880217, 0.02564844586525467, 0.007901256537722555, 0.0, 0.009737365650486935, 0.014514330484251017, 0.0, 0.003412722025163431, 0.0],
        [0.06074689776098344, 0.0, 0.0398715656533309, 0.04600196614496025, 0.008503247132337573, 0.024512557110041907, 0.0416291795861904, 0.0, 0.0035435153315214593, 0.0, 0.012644958998256964, 0.0030626438867070787, 0.011590731016474693, 0.04687065161139258, 0.04151497038400117, 0.06984388111097245, 0.03332454710620443, 0.03499850420377233, 0.019876820528534796, 0.0, 0.024220507134363075, 0.0, 0.015597148108974494, 0.020735729275610404, 0.008368229456594744, 0.0, 0.0036972523468392048, 0.029226888888072726, 0.01753800548054705, 0.0146792703753264, 0.01545990439310145, 0.0, 0.012965674909133095, 0.0, 0.003417724650877044, 0.0007953442339566539, 0.0, 0.015784309044292438, 0.017622787085916816, 0.0004379674710703683, 0.0, 0.0, 0.0, 0.005515839904920589, 0.0137547540900788, 0.0, 0.024563005181151766, 0.0, 0.007101065308489871, 0.0, 0.044205960811484375, 0.03189408345462347, 0.0, 0.016085242330422432, 0.0, 0.00020675591613892978, 0.01372626368096569, 0.007071541523031124, 0.014791742105930376, 0.0, 0.027467512447971187, 0.0, 0.0006295722501479771, 0.013775159536483159, 0.004975328202752396, 0.0891345668397029, 0.0, 0.04094898198182698, 0.0, 0.03486635637292106, 0.011097225209002116, 0.02738705284689486, 0.043157761278244014, 0.08544686890853011, 0.0, 0.05070998188823004, 0.03791707136948129, 0.009928241775136584, 0.00071446778678581, 0.07620913723732696, 0.0, 0.0, 0.015147092348787661, 0.01975952859003793, 0.03613284418283599, 0.09415757643160781, 0.0, 0.004885125350040364, 0.0, 0.011308836273063559, 0.0024933210620257896, 0.010175465675326708, 0.0, 0.004001170788092109, 0.0],
        [0.061805203204693175, 0.00847253041796912, 0.05526642788339777, 0.04685455466779565, 0.010746667313268548, 0.025894112471642236, 0.049700961660057406, 0.0012623975460382235, 0.01019623791539604, 0.0412762922832695, 0.017117611914713168, 0.0, 0.013341382105101286, 0.04052972226723466, 0.03026036639530158, 0.06767630193186729, 0.008473422370591656, 0.05035743120466428, 0.0, 0.005299559275954581, 0.014912878088554168, 0.007612989424321997, 0.0015061968413405155, 0.0009487208081284428, 0.015624819808820927, 0.013524067173364214, 0.0024479185520483865, 0.006305820101406562, 0.01730638007816005, 0.01652089353237666, 0.0013090349185215372, 0.0074894867550890564, 0.0, 0.023469957326066788, 0.006405493759696029, 0.012228598578696449, 0.0, 0.0, 0.005457527607533477, 0.006781955980944372, 0.005671557558884139, 0.005489289308484326, 0.0007935793193663103, 0.003265988659290463, 0.009300090934207061, 0.0, 0.0, 0.0, 0.0, 0.012887313846875099, 0.01202950833045691, 0.008634576681161731, 0.007429497406708452, 0.0, 0.0, 0.0, 0.0, 0.0, 0.02581309986959699, 0.003704256995214303, 0.0, 0.006066424496010837, 0.012440208539615756, 0.04707283451149716, 0.0024429761008618973, 0.065435168357097, 0.003879476882873288, 0.017275875022682564, 0.0, 0.028436608060714488, 0.019465727359970476, 0.019658902958081724, 0.024364399023113645, 0.10755377100332372, 0.000583599164054567, 0.052854970310514005, 0.040889744245415624, 0.0, 0.01819782676101956, 0.09588726280965054, 0.010647841796150468, 0.0034191433117763265, 0.023794164794206332, 0.022222095183786462, 0.014163299728501983, 0.097730470886038, 0.0035612115891681785, 0.03193432136900494, 0.0, 0.0, 0.0, 0.016144156513925922, 0.0, 0.017201393871397665, 0.012308887254476144],
        [0.044853464221717376, 0.0, 0.04837785153777719, 0.05651660329058894, 0.011369324593547054, 0.0008903887960172874, 0.038622604457269255, 0.0016056585084597622, 0.001090023388960383, 0.008498809250664912, 0.005212389773387475, 0.006689354606990332, 0.017707093606836977, 0.046351123224841376, 0.03042145227775314, 0.05093549222445317, 0.030811993705664557, 0.03990104663107166, 0.010501938827629086, 0.009133955862779075, 0.0045558653599830625, 0.0, 0.0, 0.004320741561297569, 0.03171576138936825, 0.010230963598845557, 0.0, 0.014428220967174592, 0.024467809569862747, 0.010961683504393235, 0.018651834380310522, 0.0032131419725071166, 0.013701937552971492, 0.0, 0.0, 0.03231510869560987, 0.0, 0.019713036858664365, 0.020614727758374585, 0.007875337745045827, 0.03826506948382017, 0.029498932929054363, 0.00438243324473956, 0.0022697473801270174, 0.0, 0.0, 0.009961880053418276, 0.0010914485222300514, 0.003337175493755875, 0.0, 0.014300372925367661, 0.015877889908641606, 0.0018533515801143047, 0.0, 0.017650691870519507, 0.02029290195404706, 0.0, 0.0064771105501696125, 0.000949433886939635, 0.0029890095957264408, 0.011066608404026412, 0.007368384625201674, 0.016908173371710664, 0.017951762567051846, 0.008680811613270957, 0.0845455887607609, 0.0017124477175592362, 0.03227645612477855, 0.0, 0.020410743827506968, 0.009048484335829476, 0.0, 0.0549828009207279, 0.09627972109395613, 0.009720041680721877, 0.034731557816280095, 0.05572068801716658, 0.0013515997404217512, 0.0, 0.08246718048364737, 0.011358067739639842, 0.0194967583692938, 0.0029826602475777103, 0.023164643629074146, 0.03960510903110268, 0.08398414887575367, 0.0, 0.012093163345336989, 0.010259511098079405, 0.0, 0.0, 0.0, 0.02033460755939305, 0.0, 0.0],
        [0.0466333955296898, 0.0, 0.04402787770967283, 0.07049339960937101, 0.003116604053882058, 0.0, 0.05083129597013476, 0.0, 0.012483089874463848, 0.017782701961712527, 0.004989309295356277, 0.02551827967033685, 0.0021891723639060785, 0.03476759293134725, 0.03267860778741065, 0.055376890501513024, 0.02293390739328844, 0.04991562517575474, 0.014191428181658331, 0.0, 0.00776218103831263, 0.04020888565321755, 0.0071375664391701565, 0.0025629837118885425, 0.010269983652017103, 0.009627337788534862, 0.006589154588360915, 0.03417779040598764, 0.006605944503483377, 0.0, 0.01063340710324706, 0.006818171425815628, 0.0, 0.01830680773131115, 0.008820034645862456, 0.010975970314351245, 0.007192494052925805, 0.008626919101886048, 0.009868960033867214, 0.0, 0.02968667233070872, 0.00038614988165116756, 0.0019261405833216755, 0.007695983414394907, 0.010175944977486945, 0.0, 0.0, 0.0, 0.0012175567825321084, 0.0, 0.013529532860821463, 0.010661791329644663, 0.002925862291283072, 0.0009590776185116174, 0.009201515278232784, 0.012293210745319756, 0.0, 0.01775527246086212, 0.0, 0.004782919085379902, 0.0, 0.013153553860486167, 0.023868131519571477, 0.011571196053972796, 0.0010451190358268681, 0.08482161711791392, 0.004730511378414473, 0.027527476813273957, 0.0, 0.010263169319434325, 0.0, 0.002771943385998031, 0.04088591480663355, 0.08947884336896675, 0.0, 0.037569638386981755, 0.047974351553879316, 0.020238721110928296, 0.007859272237326544, 0.0810488979507477, 0.0, 0.014462673631354584, 0.034774258146732864, 0.027843163981831058, 0.016981374953802773, 0.07335853326780548, 0.0030965233393320272, 0.0341403729626231, 0.0, 0.0006758396115089117, 0.0005833576087877062, 0.0006316354143552408, 0.00813470692342657, 0.0, 0.0009380382831135521],
        [0.06623109207834, 0.0, 0.05729334444253888, 0.05360367087857896, 0.0, 0.007454598369500961, 0.01273208875017763, 0.0022129314541607585, 0.0006120918175069791, 0.00648176409052763, 0.0, 0.0024836361852907125, 0.0017728590058801157, 0.0498433176490113, 0.02914190210886827, 0.07527831672468274, 0.01566964227245036, 0.05212063990784349, 0.01435087781346783, 0.0, 0.019305574734095294, 0.0011149464936591668, 0.012636379836102548, 0.005850413083604894, 0.023350048721749925, 0.00883347169769018, 0.013430241610521983, 0.01943430659637772, 0.011683368239587641, 0.016623112959016553, 0.02571495199435098, 0.013985929521176162, 0.0005024013772319449, 0.0017642505254473946, 0.01590532798335619, 0.0, 0.011847415825877533, 0.014196929328137296, 0.009843340988505839, 0.01181517033235983, 0.02345617837417516, 0.0, 0.015712800093303114, 0.009352827301074874, 0.0, 0.0, 0.0, 0.0004668281703432077, 0.018421059513850313, 0.0031062619805995997, 0.005000861688062172, 0.030193398499874718, 0.00257405319313589, 0.006866059888992161, 0.024612580863900488, 0.0032363730290188783, 0.0, 0.016513258343955027, 0.02024653668160659, 0.005016645108289189, 0.0286783965117706, 0.01074252134825121, 0.006571801751436918, 0.029456715420840777, 0.018853667675463356, 0.09090593917621807, 0.005838132395560969, 0.023062207984993047, 0.0, 0.042754982046868735, 0.013879788697602886, 0.027284472045122056, 0.03411637121589083, 0.08140685547835398, 0.0, 0.04428467942253371, 0.055267039667587115, 0.005966643297628034, 0.016489923941307223, 0.07330411730411765, 0.0, 0.019888318118801228, 0.022243253929161218, 0.0117960250326376, 0.019996325322285513, 0.09449688860348662, 0.009773976360554014, 0.03137880110478863, 0.0026564925871005104, 0.0, 0.005577690525476446, 0.0, 0.0, 0.0, 0.0],
        [0.051865181402049675, 0.024286777293252147, 0.06441163815714321, 0.05111243537251951, 0.007610655081771515, 0.012984931695717362, 0.03561208778071452, 0.0026988555550563308, 0.0, 0.015025268749188764, 0.0, 0.0, 0.006735402450299482, 0.043743362770821935, 0.023553869699326793, 0.057451264823712794, 0.009728405975458904, 0.05304582135444762, 0.015232218149931944, 0.0, 0.002728832540188816, 0.004287417255785604, 0.01632932512019276, 0.0, 0.01724118219732087, 0.014444281120356508, 0.009365978618702335, 0.005974280825529697, 0.0063354321153971235, 0.0070077668155137315, 0.019807427047732203, 0.0, 0.008527632006352877, 0.0042183373016239254, 0.020618613144187135, 0.0037881510539355284, 0.0, 0.017113084460067554, 0.0, 0.0, 0.0, 0.00019067981306652299, 0.02144392484848375, 0.014764737340049773, 0.0, 0.0046841823957333795, 0.013943956794072367, 0.0, 0.023915749439574162, 0.006744968200406971, 0.02346147579423877, 0.0025804109892457114, 0.012697462001055863, 0.014890913699067223, 0.0, 0.0, 0.014340274746059083, 0.0, 0.0, 0.00544182782587397, 0.013341392598714048, 0.0, 0.0014627039556550526, 0.021627309565674, 0.0, 0.09688393368843162, 0.004045414535532893, 0.043983518074074315, 0.0014881457918262753, 0.026000707713014912, 0.011286103808893267, 0.018354412108400074, 0.032298099175967966, 0.09520235893359776, 0.0, 0.05084984733025255, 0.07181217705896092, 0.0, 0.015519816166522296, 0.0636857437377707, 0.0, 0.008038113578646335, 0.0, 0.0390000537159754, 0.020584707559742222, 0.07110963989100305, 0.00048103672400420956, 0.028213685215256537, 0.01255342344174962, 0.003023300466375677, 0.008853318135310578, 0.034394144867648746, 0.0, 0.01886697754110835, 0.0],
        [0.05705954918811766, 0.0, 0.07275129376118243, 0.05828831676880321, 0.0015231092529836843, 0.014567135237112928, 0.05523224346865301, 0.013819914128175459, 0.014493277081768549, 0.0, 0.027791011375324543, 0.0074943364334980256, 0.0, 0.03885041471579982, 0.03931825301647605, 0.05543607907006119, 0.032849316142335466, 0.03956039986956103, 0.007356972345440865, 0.003071935029394147, 0.02644204006953576, 0.013676276895534079, 0.0, 0.013524019918375561, 0.004209813832475508, 0.013990966562734318, 0.021861495061833033, 0.03280658830723275, 0.007370319227057577, 0.008395280688869158, 0.006993269301811488, 0.0024408621842225108, 0.001938737368806648, 0.01147790143292768, 0.01756583247813339, 0.0, 0.004456824116973458, 0.008498679569191415, 0.013129064198028265, 0.0, 0.0, 0.014067607343571554, 0.004176938735436859, 0.009939622816765773, 0.02418458714868297, 0.025478060850039706, 0.006938496905116489, 0.006172547284334694, 0.005065892254120465, 0.01675506740875393, 0.0, 0.00512655705440861, 0.0, 0.006849593809897128, 0.01575478468346117, 0.0, 0.012137790145623991, 0.012637915943401839, 0.0, 0.006964689687550683, 0.0, 0.0, 0.0, 0.013015835562699214, 0.009581765752585793, 0.07777960492040299, 0.004304948397818716, 0.008264826675450032, 0.0, 0.027203587046955392, 0.005429221518879944, 0.02238726022816407, 0.04033289376994639, 0.08860990831716516, 0.021256041642640826, 0.019455149852382204, 0.036268634782239524, 0.0, 0.01765537146690502, 0.08544416109452395, 0.0, 0.003471587370587208, 0.009348030172886986, 0.020060312388663987, 0.011924396334815176, 0.08686987996925453, 0.0028781020230608636, 0.023750823414503974, 0.0, 0.0, 0.007992996940530609, 0.016840837014691502, 0.008261802270193387, 0.0035507982409301374, 0.008099978018062098],
        [0.07677008754350437, 0.020176894694177695, 0.0682276073731844, 0.05205394770891949, 0.0, 0.018749662120463372, 0.02607789336612783, 0.0, 0.0, 0.01909002029323282, 0.011181228550392193, 0.016261998218338146, 0.015732072162300798, 0.05639266738475903, 0.023421694472550485, 0.059210187432604, 0.027044889936786918, 0.0346417694907062, 0.017216190752484154, 0.0, 0.020421165683213213, 0.0012125817508662011, 0.0, 0.00452728843063625, 0.009705233233890812, 0.028351317169889777, 0.003086484653883558, 0.007780344301010701, 0.027318439054043478, 0.0, 0.008734274558756474, 0.00928249327521721, 0.0015491617705602593, 0.0, 0.00010462726904742099, 0.0, 0.010243193863299053, 0.0007756671611134219, 0.013563594850869727, 0.023770411780620816, 0.0, 0.0, 0.013894316267608722, 0.0, 0.009635189808398854, 0.0, 0.0, 0.0, 0.019321332860587234, 0.0011591248049296898, 0.018358708480828274, 0.003944483833682101, 0.0, 0.003798890894739528, 0.017833865928071266, 0.003941476134929902, 0.01082424521540801, 0.007579231546364893, 0.0019199260474114482, 0.021827383080747213, 0.005977666947226221, 0.0, 0.024640800350785946, 0.00969287552589548, 0.0, 0.08108693218244059, 0.010080719797725762, 0.02196660715010424, 0.0, 0.024212710269648354, 0.022876307537314115, 0.01409751685156416, 0.027770815792305725, 0.09663750533571869, 0.009279059999569789, 0.03710657388514801, 0.0626107616903417, 0.006398246480668642, 0.0, 0.0854080302707462, 0.010059428659663465, 0.005939796639753719, 0.02015299525949789, 0.036137479874005396, 0.02606979871395542, 0.08692750675487924, 0.0, 0.01897806437324539, 0.0, 5.7208723830215104e-05, 0.0, 0.01643495541530554, 0.00518287719418945, 0.006188194260386061, 0.01568118857329304]
    ]
    # -- Positives -- #
    # best_instances = [
    #     [0.10344963439711745, 0.005984373620901524, 0.0, 0.027050013558519912, 0.008062048942242656, 0.0007328304076113681, 0.0006987845323476796, 0.00960355856630376, 0.0, 0.0014319967666646576, 0.003280384152565027, 0.017007546934253676, 0.019596498061949193, 0.0, 0.023776207604073098, 0.011946727108078925, 0.0009692432748485509, 0.0, 0.0, 0.012619404776667127, 0.016201214986010754, 0.005249941151527816, 0.01967073970726604, 0.02360438537251179, 0.0026674825053355643, 0.0008745042650130171, 0.03694279104908219, 0.0248068412604982, 0.0630423895248573, 0.04124402003237733, 0.05231421936866314, 0.00347914606414643, 0.011604085892031534, 0.0032105880539624945, 0.0, 0.0075533416202635175, 0.03503823674002145, 0.0003108169530921838, 0.013478433549993373, 0.018269908192199515, 0.0, 0.0, 0.0, 0.003693606013457444, 0.01845863829535642, 0.010878961456349968, 0.008909861750346533, 0.0, 0.0, 0.0, 0.0, 0.01910088366390429, 0.0, 0.0030793313174882035, 0.003010229801413, 0.020272283561662677, 0.016364002037897254, 0.012578009963195202, 0.0, 0.004045740577075673, 0.007547847204477772, 0.0, 0.00952382002518619, 0.0021085063627999823, 0.030413072556918632, 0.017500737029286423, 0.05566898384540726, 0.018877624939844947, 0.0774357448930179, 0.08837139617882238, 0.006826725009821421, 0.007221828673193509, 0.00997878500075065, 0.012391302213972655, 0.006099140900634896, 0.0, 0.006029683183583472, 0.055004503181270696, 0.10024721216577247, 0.0, 0.11617018645608887, 0.005529980434688206, 0.08081060844613872, 0.029333491181064958, 0.10315240166763438, 0.0, 0.0, 0.009657053400912774, 0.04472474269674147, 0.044944368165087026, 0.027965523537953896, 0.0, 0.0, 0.019166231559298454, 0.0041228614467687455],
    #     [0.08967600860760233, 0.0, 0.014284823165249039, 0.0012924136659912917, 0.0, 0.0, 0.0, 0.021785793015019303, 0.01688323170454523, 0.00339503909984466, 0.0, 0.011245658934396236, 0.0014586709802809645, 0.0, 0.0021811230236139564, 0.0, 0.014660515015236089, 0.0, 0.0, 0.03138598264991364, 0.0, 0.000608411525611549, 0.00256923616751587, 0.009423086340634155, 0.013093797058030203, 0.0, 0.03320581731949123, 0.011432855349413308, 0.03511920220386715, 0.035869413674549815, 0.04938296117940286, 0.0, 0.009727878717804096, 0.010069618812669405, 0.014055902807497585, 0.0, 0.022426326454717975, 0.011828456493691014, 0.0155895471219226, 0.006069115239482778, 0.0, 0.0, 0.00813469660719088, 0.008328886132593713, 0.00890072095805128, 0.03073839416010056, 0.0, 0.0, 0.009783911054022522, 0.008832340211262819, 0.0, 0.01061281680995418, 0.009827569012240446, 0.00329071605492382, 0.006947079835350133, 0.005240081324707195, 0.004243033035024638, 0.0, 0.00529456510600493, 0.019093607133129343, 0.0493534933154805, 0.016590674679982383, 0.0, 0.0038933110408682376, 0.01276641122737369, 0.037448502466307584, 0.03796103516478135, 0.027636660014473742, 0.11092148741516389, 0.06887325415666565, 0.0, 0.031805267270906955, 0.0, 0.008006881369218361, 0.0, 0.010041398077332689, 0.0022756675676602472, 0.03490161522023459, 0.07719684874982086, 0.01004693872936449, 0.11111527372058266, 0.00227810943615683, 0.048496903088832616, 0.015499969539774998, 0.0891108858560278, 0.004229657165719424, 0.002032835241932124, 0.007480715504692187, 0.05088119088847773, 0.03167508872270104, 0.03513713188557218, 0.0, 0.01085808136451041, 0.005182203591618728, 0.0012506761431940183],
    #     [0.09295951865398872, 0.003559005685200925, 0.0, 0.0, 0.002235890257794443, 0.0, 0.006099729056921837, 0.0079341342808417, 0.016688694999435753, 0.0, 0.0, 0.017660085427219595, 0.019002321717970193, 0.0009762820260416083, 0.0051113569310476305, 0.01373897242163835, 0.0014267496796490364, 0.015136208498940448, 0.0, 0.02894451738445374, 0.01922380613692144, 0.0, 0.00320546065199712, 0.0, 0.0, 0.0, 0.02731787745924997, 0.0, 0.034566891312522816, 0.03187795519197242, 0.04306209178174987, 0.0, 0.02187293586155055, 0.005707845713196083, 0.024226950085128176, 0.002441567021094576, 0.010152019458452774, 0.01422019702854197, 0.023257745726174537, 0.006430759313843562, 0.01754938098357615, 0.014996524852011374, 0.015826706430349773, 0.0, 0.007825807064877127, 0.0, 0.017042232642727893, 0.006580323054144429, 0.023609224624632837, 0.0020186990878626734, 0.0, 0.016431894910368817, 0.016516035900321788, 0.006590418760624703, 0.0, 0.0, 0.0, 0.01619117511307589, 0.02161168064874583, 0.013341099729224513, 0.0018742016079881883, 0.009120935300820757, 0.0023260920962898095, 0.0, 0.011305867855204932, 0.016495311610920597, 0.027146478853958062, 0.022974042738005, 0.1015536791169757, 0.06632924770313889, 0.01414763738004823, 0.012308016763815223, 0.014116960899548593, 0.0, 0.025392296441405116, 0.010906795884262709, 0.0014338474812042382, 0.05782188695412202, 0.07877136136229057, 0.0, 0.08702192312676539, 0.01017122623170176, 0.05365335124298478, 0.030540816068674193, 0.10698871432597935, 0.0, 0.049299317616182226, 0.006174376379531293, 0.038707086931272845, 0.04965690613854596, 0.017244776595019187, 0.004312457260595276, 0.00014092937334509066, 0.020918487218516676, 0.01568394701335983],
    #     [0.06869173817522506, 0.0016614494160328282, 0.0001385937355250482, 0.0010272225080011094, 0.0031777386146516744, 0.0, 0.006418028775777046, 0.025374403972896094, 0.022429955125787722, 0.0, 0.0029429105230055676, 0.0021630554066295903, 0.00680730573734219, 0.0, 0.016371711698290204, 0.0, 0.0, 0.0, 0.0, 0.021454657518275955, 0.0044699303991282135, 0.008377772087207946, 0.0018593291349600655, 0.0, 0.0017699115429597703, 0.0, 0.02874599698202511, 0.01200052607910185, 0.05004862941833528, 0.044492568051026506, 0.0519110746762655, 0.002438701635554049, 0.0, 0.005028730320117636, 0.014902759225981518, 0.024284841431753024, 0.0, 0.0, 0.0, 0.006672394105869208, 0.01096661245789753, 0.01903070418322305, 0.01839059696261417, 0.012313521870472972, 0.0, 0.0015305980359887341, 0.0, 0.005700820134933199, 0.018853740190282246, 0.02513529896503577, 0.002961254240213282, 0.002484116054297987, 0.011225486699300825, 0.028527534882300677, 0.0014063174486799255, 0.03433674412956779, 0.019911724695135066, 0.017746414851210302, 0.01255228851732746, 0.006073481449063619, 0.02866531658078572, 0.008876405048946772, 0.01649765716047572, 0.0, 0.020268802054495518, 0.02379312321447826, 0.01812587444811688, 0.013329204323051617, 0.11863707321847554, 0.08508606904940999, 0.01220066295631871, 0.0, 0.0, 0.0, 0.0014798457513539543, 0.004390265981739687, 0.03590638685285608, 0.031500731171605914, 0.09720421391042552, 0.01134367100932408, 0.09382229429668157, 0.0, 0.06369927581047977, 0.04400894538368507, 0.0917912609703174, 0.0043894566187552934, 0.03140221793478326, 0.006605082346277447, 0.03848323782277985, 0.04597188447810352, 0.015524037941119678, 0.0021124963496916074, 0.01084716662032942, 0.0, 0.00775042650795712],
    #     [0.06625062450839952, 0.018836567384427842, 0.0, 0.0, 0.02346951129956718, 0.0, 0.0, 0.011984069233060689, 0.0, 0.0026874568058092574, 0.010613440950621916, 0.003544803333951455, 0.022006665077061505, 0.005709036798225478, 0.011431327547399974, 0.0, 0.0, 0.0, 0.0, 0.02388395731454108, 0.0, 0.0, 0.007047069442866822, 0.007654937331410638, 0.0, 0.006960709670679804, 0.01275330541255339, 0.021038298596334173, 0.0049849977716362615, 0.04435008962168197, 0.01202338039338301, 0.009879043853375577, 0.015602993389738959, 0.0, 0.0055907335643024135, 0.001979005358184024, 0.02067167822891358, 0.0, 0.0029777916467822363, 0.01808252151301153, 0.0, 0.010322568512359062, 0.0, 0.0, 0.008000356307435688, 0.00974253372298527, 0.010626379145920881, 0.0, 0.0018288240040821332, 0.009842959681901407, 0.0, 0.009544571474684687, 0.002060171211317886, 0.00750983022910494, 0.021788565365908563, 0.001826695377152053, 0.005031598216772594, 0.02514713093555622, 0.004572904375496456, 0.013904178775164144, 0.0, 0.014080435493774513, 0.008098763467176572, 0.0026514174956303012, 0.015964704389515794, 0.027817748814286457, 0.028824629437265763, 0.025226425524693827, 0.08714754102873798, 0.08622543647583948, 0.000928384247739892, 0.037721406581383995, 0.012864413536735862, 0.0, 0.02904355160063877, 0.0, 0.00246883163174745, 0.05172122722986197, 0.09417447107610494, 0.013554983801964484, 0.13439830794854044, 0.0, 0.05765833768344464, 0.06390684863610423, 0.10019360164071076, 0.0, 0.008507894540214927, 0.0, 0.030050048309503696, 0.05259838089833298, 0.013293737234454551, 0.032254767835729656, 0.01969239956227604, 0.007503262203347002, 0.005776837301136142],
    #     [0.0602241188910856, 0.007879832201851372, 0.003276286260875258, 0.0026924046621635985, 0.0, 0.0, 0.01232487166844503, 0.01667060565138899, 0.030521848192853265, 0.01104836400837178, 0.006369135760329379, 0.014689016924734406, 0.008949251864894169, 0.0, 0.0, 0.006836084351867057, 0.0, 0.0, 0.0, 0.0012869717806260304, 0.0010736166463519619, 0.01915638482812513, 0.00968511316932253, 0.0, 0.0, 0.019100194980503228, 0.04630455207807936, 0.0, 0.02738669484116906, 0.041977635800632476, 0.022475753154134456, 0.01909358161470686, 0.017825702324065, 0.003523563873390321, 0.001167606975777757, 0.01643952208782019, 0.03361396201606497, 0.017054923519554982, 0.01204135478743772, 0.004027294364932724, 0.008213551102524311, 0.009533430490340802, 0.011647102791863212, 0.004107208928035785, 0.00404090140895269, 0.027348436423158526, 0.017843621583615243, 0.012856759429134841, 0.009118984261464295, 0.0007142471426259225, 0.0, 0.0, 0.008856152650033157, 0.013639774915493712, 0.0, 0.01936367903751982, 0.0, 0.023824953360716154, 0.0, 0.014145256369437935, 0.0019190405538585128, 0.043825232652961496, 0.00737219040707133, 0.0010094215229274964, 0.0011981424546882967, 0.003715782025048353, 0.02459853951251385, 0.03926480957888361, 0.08883831559720212, 0.06859240458171298, 0.00846866215736531, 0.023548713622126405, 0.01457819804591805, 0.0042630594305117795, 0.009403340101895996, 0.0, 0.032862743925839974, 0.04682260824012438, 0.062069653415545746, 0.006566544923827508, 0.1042137139629177, 0.0029055300249146666, 0.05675511166119285, 0.05063392402033571, 0.10667066702846405, 0.0, 0.013879335892452074, 0.004007724040580203, 0.03921213215603534, 0.054714717242543585, 0.00437283193223995, 0.01003404387979332, 0.0, 0.011097037191418463, 0.01032748393154198],
    #     [0.09343685437803655, 0.015974162639731317, 0.018851350625741302, 0.0, 0.004820253592735828, 0.010993560903526935, 0.0, 0.02113853875699728, 0.008702662809690924, 0.019251245097416637, 0.0, 0.01903022133088135, 0.003881562382658318, 0.0, 0.00885855410419329, 0.00737149615196608, 0.014364636050868502, 0.003402257248667837, 0.008225090550470267, 0.02175487259574288, 0.001875541736007956, 0.0032916988451465144, 0.02576963183075942, 0.005757956832558847, 0.010500544068170354, 0.0019179279122897826, 0.01273047265437512, 0.0020210524793073496, 0.05816705416794442, 0.043636522669901964, 0.027730562913142486, 0.0, 0.020180174257678152, 0.0, 0.004137199528132327, 0.011736730710224257, 0.03824315447290165, 0.0, 0.015711468474083737, 0.021258288616651508, 0.0, 0.008030621130131048, 0.01398669893608427, 0.0, 0.005208680397259311, 0.0, 0.0, 0.011784860485067208, 0.010027395482178804, 0.018718452859245047, 0.012492020965013187, 0.03006881726199633, 0.022144065905216004, 0.012902499725792712, 0.007708323339889533, 0.0, 0.0013639612902803062, 0.021039277532653618, 0.0, 0.026074060456501978, 0.0, 0.010636267519875111, 0.0, 0.0, 0.023890413394689013, 0.008659862182754607, 0.03873787834926634, 0.02162073011899135, 0.1261523151623613, 0.09876291506027356, 0.0, 0.021733002724596353, 0.021098570436568594, 0.0, 0.02464544234758607, 0.011188554803862365, 0.007336987579537229, 0.05195329978886977, 0.09640518476625475, 0.017746559211381373, 0.0883792212867747, 0.014193616465423034, 0.03916038160498447, 0.04866989607955757, 0.09315382253783346, 0.0, 0.01870111481874956, 0.019504101626429418, 0.060254656791000796, 0.03078535146540552, 0.01606458991772147, 0.020599925707654506, 0.004744421790981248, 0.0, 0.005818617999860676],
    #     [0.10177452909254187, 0.012763031038542878, 0.007530555086752785, 0.0029123063467346665, 0.0, 0.0, 0.002037590983395005, 0.0, 0.008492129409245446, 0.0018798360187239167, 0.0, 0.002270145685796427, 0.015976478094956566, 0.0, 0.0167438017165701, 0.005786419254540284, 0.02113005350418821, 0.0, 0.0, 0.011503653715707024, 1.843693978614315e-05, 0.015220166293633843, 0.027295263266052992, 0.0020624088866153497, 0.0022301085993005924, 0.013477832375877127, 0.022369636507991574, 0.049470857757243004, 0.04890618958289829, 0.05949438593548311, 0.03502720409101361, 0.0014019094551604664, 0.0, 0.004574146348076076, 0.0, 0.02772847757128396, 0.015541642829906216, 0.0004655694301003259, 0.011677418998658227, 0.009692446436708923, 0.0, 0.0, 0.0007295484204711926, 0.0, 0.01264164300917776, 0.007008737490000604, 0.01738197573556225, 0.0021993947576757584, 0.0, 0.008042623188598132, 0.037973383400006167, 0.00017632183854226872, 0.027415394769474584, 0.0063942992473969605, 0.0, 0.0050024335376237855, 0.0, 0.01445048638464221, 0.006342553855077974, 0.016837481291671827, 0.0, 0.006152533893661774, 0.02013348113341648, 0.0, 0.0056347219465395885, 0.002745538960994903, 0.04400687600292913, 0.025838646820927246, 0.10649342575996473, 0.08201442740352606, 0.009279866274734861, 0.021002327234034345, 5.767610733459563e-05, 0.0, 0.0009252842288841787, 0.010039546891982415, 0.022763247912085324, 0.07199469130586512, 0.07594120426532042, 0.01301034010542593, 0.06340907542147822, 0.014402225517783182, 0.05933650238784057, 0.03830645646990348, 0.0954571116661353, 0.0, 0.016404559584103733, 0.028738836345081367, 0.045348884222187025, 0.015241724231907363, 0.0, 0.009534598880483216, 0.0138480688214716, 0.027749276589248396, 0.0],
    #     [0.08087369371034273, 0.018110969115122402, 0.015450039540967374, 0.0, 0.0020675496938806037, 0.004285450538459919, 0.009139394285075023, 0.04279537203013791, 0.012263397118395334, 0.015231685992146351, 0.002901097577508279, 0.00800034750312597, 0.004634729357168176, 0.01374238833969907, 0.0008015795429548757, 0.014841642104525741, 0.0020965612740074338, 0.00203752789057349, 0.0, 0.0, 0.0, 0.0008198782054075725, 0.012079406491538918, 0.014466634264529411, 0.008119715745965114, 0.008852283203978262, 0.043416828774152705, 0.018689486910504358, 0.02519321755486174, 0.052877014509601514, 0.04998254555146911, 0.021769136441956723, 0.0, 0.008862778262570318, 0.006988826986308224, 0.0, 0.0073911823910842046, 0.0, 0.0, 0.0022674656691412873, 0.000937041834153227, 0.0, 0.0, 0.01156395584380509, 0.00485660236883508, 0.0, 0.0028682968635980275, 0.0012004095494336326, 0.0, 0.018992608663876663, 0.0, 0.007898245553828735, 0.034829068518279174, 0.006502703616618748, 0.0, 0.02121016103805517, 0.0032406058737036113, 0.017182602213606114, 0.012337319853694496, 0.034461597292369084, 0.007132469724610117, 0.0, 0.00222147664879114, 0.0, 0.02048276916013452, 0.005101015264725912, 0.039872597887284006, 0.016037007045248543, 0.09440626059333619, 0.06771837229096195, 0.003754114564997175, 0.02692102976716087, 0.015483223993634061, 0.01248015057080886, 0.019579298549037123, 0.0, 0.0016728928773310399, 0.04444191096182453, 0.07750891595967001, 0.0019245770409691476, 0.10037595532102438, 0.002852923580159346, 0.0771179646283034, 0.03306906101597217, 0.0978462987233287, 0.0, 0.01829792636020726, 0.010057077094039545, 0.07725189711727173, 0.04593345100747905, 0.0, 0.0075610786634120256, 0.0, 0.02091366653642284, 0.008122976399823805],
    #     [0.08973250665900692, 0.01836851768350276, 0.04026650876864018, 0.0, 0.003273409698938039, 0.0, 0.0, 0.0, 0.010001820905084344, 0.006362851273736437, 0.0, 0.010737200554444734, 0.0, 0.00999900215610913, 0.013550220037133116, 0.0, 0.0, 0.012235651811912275, 0.0, 0.013883715733614872, 0.0, 0.020838190190280784, 0.01673738037998873, 0.013958180299311437, 0.001264233398312658, 0.0, 0.0025838972646618523, 0.0, 0.05135152063728928, 0.03765289379658766, 0.03716978716681845, 0.02844371687528816, 0.0, 0.011201696418360597, 0.0038364447378038888, 0.018057232337968424, 0.02406121165235095, 0.020606596732220216, 0.0, 0.011807443462470538, 0.0, 0.0, 0.023316754761086217, 0.004958774966887136, 0.0028629030716103053, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.017742663752548876, 0.00034571277695155623, 0.028155188938449486, 0.010918742262656541, 0.03796340390722343, 0.007596622421294811, 0.020477726503101288, 0.005287815843976812, 0.015011513347836892, 0.0, 0.013408051526399168, 0.008630042256285005, 0.0050327579528213345, 0.0, 0.003318025157558016, 0.04189547303886463, 0.015307402910816425, 0.1140267934424402, 0.06606150131633494, 0.0031710506602019347, 0.04805799380808535, 0.004285797974886473, 0.003332545075460816, 0.0361643991423024, 0.0023241355827449, 0.007866073404424283, 0.042324736229825216, 0.07492305505934503, 0.0, 0.10317637268350184, 0.0, 0.04365721347888396, 0.03978615818729775, 0.10031753736807374, 0.0, 0.015530548257900154, 0.0021255918745723707, 0.05926929211505291, 0.02258830635530821, 0.03931735981760832, 0.02348466416652725, 0.026662915826081553, 0.014339516486621486, 0.0]
    # ]
    base_dataset = "HTML_malware_dataset.csv"
    data = list(csv.reader(open(base_dataset)))
    
    row_id = 0
    shortest_ids = []
    distances = []
    for best_instance in best_instances:
        best_instance = np.array(best_instance)
        best_instance = best_instance.reshape(1, -1)

        shortest_distance = 999999999999
        shortest_id = -1
        print(f"---------- New Instance ----------")
        for i in range(len(data)):
            if i == 0:
                continue
            instance = data[i][2:]
            instance = np.array(instance)
            instance = instance.reshape(1, -1)

            euclidean_distance = euclidean_distances(best_instance, instance)[0][0]
            if euclidean_distance < shortest_distance:
                shortest_distance = euclidean_distance
                shortest_id = data[i][0]
                print(f"New shortest distance {shortest_distance} at id {shortest_id}")
        shortest_ids.append(shortest_id)
        distances.append(shortest_distance)

    print(f"Shortest IDS: {shortest_ids}\n")
    print(f"Distances: {distances}")


# measure_distances() 
